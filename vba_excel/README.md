# VBA 매크로
## VBA 매크로 사용 전 세팅하기
1. 보안설정  
    * [보안센터] - [보안센터설정]  
    * [매크로설정] - '모든 매크로 포함'과 'VBA 프로젝트 개체 모델'에... 체크하기  
    * [제한된 보기] - '인터넷에서 가져온 파일...', '안전하지 않은 위치에...', 'Outlook 첨부...' <u>체크 해제</u>하기  
1. 개발도구 화면에 띄우기  
    * [파일] - [옵션] - [리본 사용자 지정] - 우측의 [개발도구] 체크하고 확인
2. 참조도구 가져오기  
    * Alt+F11(VBA 화면) - [도구] - [참조] 
        > Microsoft HTML Object Library  
        > Microsoft Internet Controls  
        > Microsoft XML, v6.0  
        > Microsoft Forms 2.0 Object Library    

        항목에 체크하기
3. VBA 화면 설정하기  
    * [보기] - [직접 실행 창] 클릭  
    * [보기] - [도구모음] - [디버그], [편집] 체크  
    * [도구] - [옵션] - [편집기 형식] - [글꼴] - 'Consolas'로 변경
    * [편집기 형식] - [편집기] - '자동 구문 검사', '변수 선언 요구' 체크  
4. 엑셀 모듈 생성하기
    - VBA 화면 좌측 상단의 **'프로젝트'창** -> '내 엑셀 파일명'의 [**'Microsoft Excel 개체'** 폴더] 확인하기
    - [**'Microsoft Excel 개체'**] 우클릭 - [삽입] - [모듈] 클릭
5. 엑셀이 32 or 64비트인지 확인하기.
    * [파일] - [계정] - 엑셀 정보 클릭
## 구현기능
* 엑셀 최초 실행 시 특정 함수 작동시키기
* ~~xltm 확장자 저장 기능(최초 저장 시 다른이름으로 저장이 뜨는걸 방지)~~  
    xlsm 확장자로 저장 기능 - xlsm 확장자로 저장할 경우 '다른이름으로 저장'이 뜨지 않는다.
* 실행하는 창 크기 조절(엑셀 WorkBook/IE 등...)
* 엑셀에서 작동하는 모든 기능 매크로로 전환 후 실행
* 현재 작업중인 내용 저장(ctrl + s)의 자동화
* 인터넷 열기(IE)
* HTML 태그 id, class를 찾아서 자바스크립트 실행
    > 자동로그인 기능
* 마우스 포인터 위치를 x,y 좌표로 출력 > 마우스 이벤트와 연결
    > 반복해서 동작하는 모든 과정의 자동화 가능
* ~~접수번호로 검색을 띄운 뒤, 로딩이 끝나면 상세페이지를 더블클릭하기~~ solved by 220622 00:23
* 어느정도 만들어진 모듈이나 엑셀파일을 전송 할 경우 다른 엑셀에서도 자체적으로 동작하게끔 하고 싶다. (내가 코드 수정하지 않도록)
    > * ~~아이디값 입력한 셀로 시작페이지 아이디 자동 채우기~~ solved by 220622 23:56  
    > * ~~마우스 좌표 매크로도 MsgBox 방식을 활용해서 각자 구한 다음 그 값을 x,y 좌표 셀에 입력해서 더블클릭 하게 만들기~~  solved by 220622 23:40
## TODO
* 기능들의 모듈화
* '사용자 정의 폼' 생성 시 번거로운 과정 줄이는 방법 찾아보기 (그리듯 생성하고 값 하나씩 수정하는게 너무 불편함)
* Always on top 기능을 '사용자 정의 폼'에 추가시키기
* 저장할 파일명 입력 시 해당 파일명으로 최종 저장본 만들기 - 오히려 더 햇갈릴 수 있다고 생각해서 고려해볼 필요 있다.  